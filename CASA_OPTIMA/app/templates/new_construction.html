<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ConstrucciÃ³n desde Cero - Casa Ã“ptima</title>
  <link rel="stylesheet" href="/static/css/styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>ğŸ—ï¸ ConstrucciÃ³n desde Cero</h1>
  <p style="text-align: center; color: #666; margin-bottom: 2rem;">
    <a href="/" style="color: #005bbb;">â† Volver al selector</a>
  </p>

  <form id="optimizeForm">
    <fieldset>
      <legend>ConfiguraciÃ³n del Proyecto</legend>
      
      <div class="row">
        <label>
          Presupuesto ($):
          <input type="number" id="budget" value="750000" min="10000" step="1000" required />
        </label>

        <label>
          Modelo predictivo:
          <select id="modelSelector">
            <option value="xgboost" selected>XGBoost</option>
            <option value="linear">RegresiÃ³n Lineal</option>
          </select>
        </label>

        <label class="precision-label">
          PrecisiÃ³n del modelo:
          <input type="range" id="pwl_k" min="5" max="40" value="25" step="5" />
          <span id="pwl_label">25</span>
        </label>
      </div>
    </fieldset>

    <fieldset>
      <legend>UbicaciÃ³n y Terreno</legend>
      
      <div class="grid">
        <label>
          Longitud (LON):
          <input type="number" id="LON" step="0.0001" value="-93.6197" required />
        </label>

        <label>
          Latitud (LAT):
          <input type="number" id="LAT" step="0.0001" value="42.054" required />
        </label>

        <label>
          Ãrea del terreno (Lot_Area en ftÂ²):
          <input type="number" id="Lot_Area" value="15000" min="5000" step="100" required />
        </label>

        <label>
          Precio del terreno ($):
          <input type="number" id="land_price" value="50000" min="0" step="5000" required />
        </label>
      </div>

      <p class="hint">
        ğŸ’¡ <strong>Consejo:</strong> Para presupuestos de $750k, terrenos de 15,000 ftÂ² funcionan bien.
        Para $500k, considera 10,000 ftÂ². El precio del terreno se suma al costo total de construcciÃ³n.
      </p>
    </fieldset>

    <button type="submit">ğŸš€ Optimizar ConstrucciÃ³n</button>
  </form>

  <!-- RESULTADOS -->
  <h2>Resultado</h2>

  <div id="summary" class="summary hidden">
    <h3>ğŸ“ˆ Resumen de optimizaciÃ³n</h3>
    <p><b>Precio estimado final:</b> <span id="price_after"></span></p>
    <p><b>Costo de construcciÃ³n:</b> <span id="spent"></span></p>
    <p><b>Ganancia potencial:</b> <span id="profit"></span></p>
    <p><b>ROI:</b> <span id="roi"></span></p>
  </div>

  <div id="tables" class="hidden">
    <h3>ğŸ¡ Especificaciones de la Casa Ã“ptima</h3>
    <table id="finalHouseTable">
      <thead><tr><th>CaracterÃ­stica</th><th>Valor</th></tr></thead>
      <tbody></tbody>
    </table>

    <h3>ğŸ’° Desglose de Costos</h3>
    <table id="costTable">
      <thead><tr><th>Concepto</th><th>Costo ($)</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Mapa -->
  <section class="map-section">
    <h2>ğŸ—ºï¸ UbicaciÃ³n en Ames, Iowa</h2>
    <iframe
      id="mapIframe"
      src="/static/mapa_heatmap_clusters_ames.html"
      width="100%"
      height="600"
      loading="lazy"
      style="border: none; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.15);"
    ></iframe>
  </section>

  <pre id="output" class="hidden"></pre>

  <script src="/static/js/new_construction.js"></script>
</body>
</html>
