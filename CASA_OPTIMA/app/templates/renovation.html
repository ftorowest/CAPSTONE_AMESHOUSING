<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Remodelaci√≥n - Casa √ìptima</title>
  <link rel="stylesheet" href="/static/css/styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>üîß Remodelaci√≥n de Casa Existente</h1>
  <p style="text-align: center; color: #666; margin-bottom: 2rem;">
    <a href="/" style="color: #005bbb;">‚Üê Volver al selector</a>
  </p>

  <form id="optimizeForm">
    <fieldset>
      <legend>Configuraci√≥n del Proyecto</legend>
      
      <div class="row">
        <label>
          Presupuesto ($):
          <input type="number" id="budget" value="50000" min="5000" step="1000" required />
        </label>

        <label>
          Modelo predictivo:
          <select id="modelSelector">
            <option value="xgboost" selected>XGBoost</option>
            <option value="linear">Regresi√≥n Lineal</option>
          </select>
        </label>

        <label class="precision-label">
          Precisi√≥n del modelo:
          <input type="range" id="pwl_k" min="5" max="40" value="25" step="5" />
          <span id="pwl_label">25</span>
        </label>
      </div>
      
      <p class="hint">
        Mayor precisi√≥n ‚Üí predicci√≥n m√°s exacta pero m√°s lenta (usa entre 10‚Äì30).
      </p>
    </fieldset>

    <fieldset>
      <legend>Caracter√≠sticas de la Vivienda Base</legend>

      <div class="grid">
        <label>Superficie primer piso (First_Flr_SF)
          <input type="number" id="First_Flr_SF" value="1656" min="0" />
        </label>

        <label>Superficie segundo piso (Second_Flr_SF)
          <input type="number" id="Second_Flr_SF" value="0" min="0" />
        </label>

        <label>A√±o de construcci√≥n (Year_Built)
          <input type="number" id="Year_Built" value="1960" min="1800" max="2025" />
        </label>

        <label>√Årea del terreno (Lot_Area)
          <input type="number" id="Lot_Area" value="31770" min="1000" />
        </label>

        <label>A√±o de remodelaci√≥n (Year_Remod_Add)
          <input type="number" id="Year_Remod_Add" value="1960" min="1800" max="2025" />
        </label>

        <label>√Årea del garaje (Garage_Area)
          <input type="number" id="Garage_Area" value="528" min="0" />
        </label>

        <label>Superficie s√≥tano total (Total_Bsmt_SF)
          <input type="number" id="Total_Bsmt_SF" value="1080" min="0" />
        </label>

        <label>√Årea terraza madera (Wood_Deck_SF)
          <input type="number" id="Wood_Deck_SF" value="210" min="0" />
        </label>

        <label>√Årea porche abierto (Open_Porch_SF)
          <input type="number" id="Open_Porch_SF" value="62" min="0" />
        </label>

        <label>N¬∞ de chimeneas (Fireplaces)
          <input type="number" id="Fireplaces" value="2" min="0" max="5" />
        </label>

        <label>Ba√±os completos (Full_Bath)
          <input type="number" id="Full_Bath" value="1" min="0" max="5" />
        </label>

        <label>Medios ba√±os (Half_Bath)
          <input type="number" id="Half_Bath" value="0" min="0" max="3" />
        </label>

        <label>Ba√±o en s√≥tano (Bsmt_Full_Bath)
          <input type="number" id="Bsmt_Full_Bath" value="1" min="0" max="3" />
        </label>

        <label>Habitaciones totales (TotRms_AbvGrd)
          <input type="number" id="TotRms_AbvGrd" value="7" min="0" max="20" />
        </label>

        <label>Dormitorios (Bedroom_AbvGr)
          <input type="number" id="Bedroom_AbvGr" value="3" min="0" max="10" />
        </label>

        <label>Cocinas sobre suelo (Kitchen_AbvGr)
          <input type="number" id="Kitchen_AbvGr" value="1" min="0" max="3" />
        </label>

        <label>√Årea piscina (Pool_Area)
          <input type="number" id="Pool_Area" value="0" min="0" />
        </label>

        <label>Latitud (Latitude)
          <input type="number" id="Latitude" step="0.0001" value="42.054" />
        </label>

        <label>Longitud (Longitude)
          <input type="number" id="Longitude" step="0.0001" value="-93.6197" />
        </label>
      </div>

      <h4>Escalas de Calidad (1 a 5)</h4>
      <div class="sliders">
        <div><label>Calidad exterior (Exter_Qual): <span id="v_Exter_Qual">3</span></label>
          <input type="range" id="Exter_Qual" min="1" max="5" value="3" />
        </div>

        <div><label>Calidad cocina (Kitchen_Qual): <span id="v_Kitchen_Qual">3</span></label>
          <input type="range" id="Kitchen_Qual" min="1" max="5" value="3" />
        </div>

        <div><label>Calidad del s√≥tano (Bsmt_Qual): <span id="v_Bsmt_Qual">4</span></label>
          <input type="range" id="Bsmt_Qual" min="1" max="5" value="4" />
        </div>

        <div><label>Exposici√≥n del s√≥tano (Bsmt_Exposure): <span id="v_Bsmt_Exposure">5</span></label>
          <input type="range" id="Bsmt_Exposure" min="1" max="5" value="5" />
        </div>

        <div><label>Condici√≥n general (Overall_Cond): <span id="v_Overall_Cond">5</span></label>
          <input type="range" id="Overall_Cond" min="1" max="9" value="5" />
        </div>

        <div><label>Calidad calefacci√≥n (Heating_QC): <span id="v_Heating_QC">2</span></label>
          <input type="range" id="Heating_QC" min="1" max="5" value="2" />
        </div>

        <div><label>Condici√≥n garaje (Garage_Cond): <span id="v_Garage_Cond">4</span></label>
          <input type="range" id="Garage_Cond" min="1" max="5" value="4" />
        </div>

        <div><label>Terminaci√≥n garaje (Garage_Finish): <span id="v_Garage_Finish">4</span></label>
          <input type="range" id="Garage_Finish" min="1" max="5" value="4" />
        </div>

        <div><label>Calidad garaje (Garage_Qual): <span id="v_Garage_Qual">4</span></label>
          <input type="range" id="Garage_Qual" min="1" max="5" value="4" />
        </div>
      </div>

      <h4>Caracter√≠sticas Binarias</h4>
      <div class="checkboxes">
        <label><input type="checkbox" id="House_Style_One_Story" checked /> Casa de un piso</label>
        <label><input type="checkbox" id="Sale_Condition_Normal" checked /> Venta normal</label>
        <label><input type="checkbox" id="Sale_Type_New" /> Venta nueva</label>
        <label><input type="checkbox" id="Central_Air_Y" checked /> Aire acondicionado central</label>
      </div>
    </fieldset>

    <button type="submit">üöÄ Optimizar Remodelaci√≥n</button>
  </form>

  <!-- RESULTADOS -->
  <h2>Resultado</h2>

  <div id="summary" class="summary hidden">
    <h3>üìà Resumen de Optimizaci√≥n</h3>
    <p><b>Precio antes:</b> <span id="price_before"></span></p>
    <p><b>Precio despu√©s:</b> <span id="price_after"></span></p>
    <p><b>Gasto total:</b> <span id="spent"></span></p>
    <p><b>Ganancia:</b> <span id="profit"></span></p>
    <p><b>ROI:</b> <span id="roi"></span></p>
  </div>

  <div id="tables" class="hidden">
    <h3>üîß Cambios Sugeridos</h3>
    <table id="changesTable">
      <thead><tr><th>Variable</th><th>Œî Valor</th></tr></thead>
      <tbody></tbody>
    </table>

    <h3>üí∞ Desglose de Costos</h3>
    <table id="costTable">
      <thead><tr><th>Concepto</th><th>Costo ($)</th></tr></thead>
      <tbody></tbody>
    </table>

    <h3>üè° Casa Optimizada</h3>
    <table id="finalHouseTable">
      <thead><tr><th>Caracter√≠stica</th><th>Valor Final</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Gr√°fico de ubicaci√≥n -->
  <div style="max-width: 600px; margin: 2rem auto;">
    <canvas id="locationChart"></canvas>
  </div>

  <!-- Mapa -->
  <section class="map-section">
    <h2>üó∫Ô∏è Ubicaci√≥n en Ames, Iowa</h2>
    <iframe
      id="mapIframe"
      src="/static/mapa_heatmap_clusters_ames.html"
      width="100%"
      height="600"
      loading="lazy"
      style="border: none; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.15);"
    ></iframe>
  </section>

  <pre id="output" class="hidden"></pre>

  <script src="/static/js/renovation.js"></script>
</body>
</html>
